#!/usr/local/bin/python
import unittest
import sys
import pprint
from os.path import dirname, join, abspath
sys.path.insert(0, abspath(join(dirname(__file__), '..')))
from cosa.search.match import *
from cosa.search.functions import *
from cosa.nlp.functions import *
from cosa.nlp.Model import *
from cosa.graph.functions import *

class MatchTest(unittest.TestCase):
    CEREALS = {'code': '1000000000-80', 'terms': {'cereals[n]': {u'cereals[n]': 1.0, u'stewed[n]': 0.7764776349067688, u'compote[n]': 0.755449116230011, u'puddings[n]': 0.7699476480484009, u'rissoles[n]': 0.7585991621017456, u'hard-cooked[j]': 0.7554789781570435, u'strawberries[n]': 0.7493680119514465, u'stuffed[n]': 0.7855944633483887, u'sliced[n]': 0.7470594048500061, u'beets[n]': 0.7468308806419373, u'vegetables[n]': 0.7578145861625671, u'braised[n]': 0.7556328773498535, u'horse-radish[j]': 0.7597455382347107, u'butterine[n]': 0.753279983997345, u'diced[j]': 0.7449774146080017, u'meats[n]': 0.7527689337730408, u'raspberries[n]': 0.7478814721107483, u'popovers[n]': 0.8091792464256287, u'cooked[n]': 0.7515818476676941, u'succotash[n]': 0.7594679594039917, u'radishes[n]': 0.746717095375061, u'cutlets[n]': 0.7511512041091919, u'cucumbers[n]': 0.7651965618133545, u'tarragon[n]': 0.757579505443573, u'reduced[n]': 0.7441823482513428, u'mushrooms[n]': 0.7890390157699585, u'prunes[n]': 0.7568647861480713, u'lemons[n]': 0.7575535178184509, u'poached[n]': 0.7699248194694519, u'unroasted[j]': 0.7560224533081055, u'corned[n]': 0.792959988117218, u'cookies[n]': 0.749269425868988, u'celeriac[n]': 0.7549691200256348, u'chive[n]': 0.7475379109382629, u'preserves[n]': 0.7537457942962646, u'scallops[n]': 0.746527373790741, u'planked[n]': 0.7591778635978699, u'creamed[n]': 0.7523108124732971, u'grilled[n]': 0.7670201063156128, u'okra[n]': 0.7945480346679688, u'soups[n]': 0.7799786329269409, u'chilli[n]': 0.770285427570343, u'dumplings[n]': 0.7757858633995056, u'hashed[n]': 0.7506567239761353, u'brocoli[n]': 0.7520615458488464, u'dried[n]': 0.8089413046836853, u'croquettes[n]': 0.7475957870483398, u'finely-minced[j]': 0.7531716823577881, u'jellied[n]': 0.7826042175292969, u'parsnips[n]': 0.761404275894165, u'cherries[n]': 0.7753180265426636, u'wines[n]': 0.7490634918212891, u'pickling[n]': 0.7451664805412292, u'mince[n]': 0.7616487741470337, u'salads[n]': 0.7466615438461304, u'salsify[n]': 0.7504962682723999, u'apricots[n]': 0.7620011568069458, u'curried[n]': 0.7748796343803406, u'malted[n]': 0.7446199059486389, u'almonds[n]': 0.7666484117507935, u'sauces[n]': 0.7901585102081299, u'scalloped[n]': 0.7710123062133789, u'tomatoes[n]': 0.7844180464744568, u'roasted[n]': 0.7706313133239746, u'truffles[n]': 0.74699866771698, u'steamed[n]': 0.7711057662963867, u'turnips[n]': 0.7592406272888184, u'lentils[n]': 0.7919096946716309, u'cooked[j]': 0.7885929942131042, u'dressings[n]': 0.7512006759643555, u'escalloped[n]': 0.7746775150299072, u'cantaloup[n]': 0.7442024350166321, u'canned[n]': 0.8098195791244507, u'minced[n]': 0.7766795754432678, u'cauliflowers[n]': 0.7439226508140564, u'desserts[n]': 0.757439911365509, u'sprouts[n]': 0.7770397067070007, u'raisins[n]': 0.7805812358856201, u'pineapples[n]': 0.7846521139144897, u'kohlrabi[n]': 0.7606574892997742, u'protose[n]': 0.7465308308601379, u'haricot[n]': 0.7529014945030212, u'wafers[n]': 0.774757981300354, u'balls[n]': 0.7494478225708008, u'puree[n]': 0.7643208503723145, u'candies[n]': 0.7488436102867126, u'currants[n]': 0.7679557204246521, u'catchup[n]': 0.7539600133895874, u'artichokes[n]': 0.7760335206985474, u'fritters[n]': 0.7545848488807678, u'rice[v]': 0.755017101764679, u'chervil[n]': 0.7520471811294556, u'salted[n]': 0.7482898831367493, u'clove[v]': 0.7437666058540344, u'catsup[n]': 0.7708659768104553, u'eggplant[n]': 0.7650061249732971, u'saut\xe9d[n]': 0.7843319177627563, u'horseradish[n]': 0.7598838806152344, u'comp\xf4te[n]': 0.7541021108627319, u'breads[n]': 0.7494605779647827, u'tartare[n]': 0.7760413885116577}}, 'parent': False, 'label': 'CEREALS', 'other': False, 'row': {'End date': '', 'Indent': '', 'Description': 'CEREALS', 'Language': 'EN', 'Hier.Pos.': '2', 'Goods code': '1000000000 80', 'Start date': '31/12/1971 '}}
    
    ANIMALS = {'code': '0100000000-80', 'terms': {'live[j]': {u"e'en[n]": 0.5564403533935547, u'there[n]': 0.5846738815307617, u'threnody[n]': 0.550804615020752, u"e'er[n]": 0.5482285022735596, u'dreams[n]': 0.5521941184997559, u'crusoes[n]': 0.548754870891571, u'liveth[n]': 0.5467067360877991, u'israfel[n]': 0.5526538491249084, u'boyesen[n]': 0.5486006140708923, u'wooing[j]': 0.5580424070358276, u"ne'er[r]": 0.5470651388168335, u'grow[n]': 0.5683231353759766, u'lovers[n]': 0.6164531707763672, u'dearer[j]': 0.6014232039451599, u'smiles[n]': 0.5742058157920837, u'born[n]': 0.6602447628974915, u'babes[n]': 0.6243681907653809, u'everlasting[j]': 0.5723127126693726, u'eyes[n]': 0.5525164604187012, u'like[n]': 0.5762818455696106, u'blest[n]': 0.6191362738609314, u'always[n]': 0.6386470794677734, u'neighbors[n]': 0.5662359595298767, u'never[n]': 0.6086260080337524, u'themselve[n]': 0.6084005832672119, u'bees[n]': 0.5527839660644531, u'posies[n]': 0.5505804419517517, u'yore[n]': 0.5514352917671204, u'longfellow[n]': 0.5481561422348022, u'remember[n]': 0.5862517356872559, u'creatures[n]': 0.5657932162284851, u'famous[n]': 0.5656535029411316, u'singing[j]': 0.629057765007019, u"l'envoi[n]": 0.5672650933265686, u'things[n]': 0.5510051846504211, u'began[n]': 0.5506722927093506, u'every[n]': 0.5693259239196777, u'lxii[c]': 0.5482818484306335, u'better[n]': 0.5758242011070251, u'blithe[n]': 0.5601811408996582, u"ne'er[j]": 0.5595470666885376, u'skies[n]': 0.5597528219223022, u'christmas-tide[n]': 0.5583484768867493, u'spring-time[n]': 0.5466658473014832, u'maidens[n]': 0.5582897067070007, u'ever[n]': 0.6308330297470093, u'themselves[n]': 0.5765517354011536, u'songs[n]': 0.5745152235031128, u'changeling[n]': 0.5559027194976807, u'because[n]': 0.548220157623291, u'bliss[v]': 0.5487252473831177, u'souls[n]': 0.603229284286499, u'anonymous[n]': 0.5916802883148193, u'best[n]': 0.6490799188613892, u'shall[v]': 0.5489336252212524, u'bliss[n]': 0.5568798780441284, u"whene'er[n]": 0.5491654872894287, u'amarillis[n]': 0.6012478470802307, u'arcady[n]': 0.563112199306488, u'hearts[n]': 0.6210923790931702, u'grown[n]': 0.6152271628379822, u'happy[n]': 0.6273986101150513, u'poets[n]': 0.5610508322715759, u'forget[n]': 0.5817203521728516, u'deathless[j]': 0.5483543276786804, u'almost[n]': 0.5541512370109558, u'though[n]': 0.5568019151687622, u'evermore[r]': 0.6290655732154846, u'joys[n]': 0.6195589900016785, u'keep[n]': 0.5704287886619568, u'would[n]': 0.5481376051902771, u'everlasting[n]': 0.5795769095420837, u'rejoice[n]': 0.549953818321228, u'spent[n]': 0.5512306094169617, u'foes[n]': 0.5560236573219299, u'learn[n]': 0.5580666661262512, u'hiawatha[n]': 0.5731965899467468, u'kiple[v]': 0.550570011138916, u'greatest[n]': 0.5965345501899719, u'gone[n]': 0.5749112963676453, u'beasts[n]': 0.5573819279670715, u'limberlost[n]': 0.5519741177558899, u'yohn[n]': 0.5576248168945312, u'blest[j]': 0.596335768699646, u'bless[n]': 0.5703737735748291, u'stratton-porter[n]': 0.5572399497032166, u'playmates[n]': 0.5597869753837585, u'bring[n]': 0.5539402365684509, u"ev'ry[n]": 0.5657252669334412, u'aflame[n]': 0.5605417490005493, u'nightingale[j]': 0.5469585657119751, u'mongst[f]': 0.5518596768379211, 'live[j]': 1.0, u'swim[n]': 0.5605383515357971, u'heroes[n]': 0.5534107685089111, u'much[n]': 0.5871523022651672, u'whose[v]': 0.5510176420211792, u'taught[n]': 0.60356205701828, u'written[n]': 0.5501471757888794, u"where'er[n]": 0.5462478399276733, u"ne'er[n]": 0.5577762722969055}, 'animal[n]': {u'taxidermy[n]': 0.663212239742279, u'baring-gould[n]': 0.6658204793930054, u'discoveries[n]': 0.6736807227134705, u'suggestions[n]': 0.6456446051597595, u'mammals[n]': 0.6991199851036072, u'invertebrated[n]': 0.6768133044242859, u'tasmanian[j]': 0.694990336894989, u'introductory[n]': 0.6810227036476135, u'collecting[n]': 0.7031161785125732, u'reptiles[n]': 0.737564742565155, u'ideas[n]': 0.6791789531707764, u'containing[n]': 0.6564715504646301, u'mammalia[n]': 0.663221538066864, u'encyclop\xe6dia[n]': 0.6763244867324829, u'carnivorous[n]': 0.6461517810821533, u'researches[n]': 0.6644724607467651, u'curiosities[n]': 0.6662635803222656, u'their[n]': 0.7219755053520203, u'critical[n]': 0.6548103094100952, u'tylor[n]': 0.696605920791626, u'butterflies[n]': 0.6992760300636292, u'ornithology[n]': 0.7132249474525452, u'according[n]': 0.6572780013084412, u'fungi[n]': 0.6483606696128845, u'lankester[n]': 0.6868953108787537, u'animal[n]': 0.647206723690033, u'races[n]': 0.686678409576416, u'adventures[n]': 0.6553552746772766, u'marsupial[n]': 0.6539807319641113, u'types[n]': 0.7186300754547119, u'folk-lore[n]': 0.6815694570541382, u'words[n]': 0.6490551829338074, u'wasps[n]': 0.6644031405448914, u'various[n]': 0.7205750942230225, u'sketches[n]': 0.6480950117111206, u'carnivorous[j]': 0.6478617787361145, u'bees[n]': 0.6474546790122986, u'studies[n]': 0.6984114646911621, u'some[n]': 0.754544734954834, u'sports[n]': 0.6490011811256409, 'animal[n]': 1.0, u'mammal[n]': 0.6508640646934509, u'facts[n]': 0.64410001039505, u'batrachian[n]': 0.6866065263748169, u'things[n]': 0.6574070453643799, u'fishes[n]': 0.777327835559845, u'domestication[n]': 0.6949230432510376, u'entomology[n]': 0.6900819540023804, u'numerous[n]': 0.6533589363098145, u'ichthyology[n]': 0.6444573998451233, u'scientific[n]': 0.6459745764732361, u'only[n]': 0.648414671421051, u'zoological[j]': 0.6505564451217651, u'known[n]': 0.6712250709533691, u'howitt[n]': 0.7344872951507568, u'quadrupeds[n]': 0.6931967735290527, u'invertebrate[n]': 0.6611196994781494, u'each[n]': 0.6624296307563782, u'sexual[n]': 0.6572558283805847, u'beetles[n]': 0.6479928493499756, u'insects[n]': 0.8104918599128723, u'these[n]': 0.6608797311782837, u'sporting[n]': 0.6766088604927063, u'grown[n]': 0.6458300948143005, u'chapters[n]': 0.6710800528526306, u'naturalists[n]': 0.651248037815094, u'folklore[n]': 0.7143479585647583, u'siouan[n]': 0.6536747813224792, u'rodent[n]': 0.6463885307312012, u'kinds[n]': 0.6760766506195068, u'brinton[n]': 0.6847958564758301, u'essays[n]': 0.6485468745231628, u'myths[n]': 0.6793152689933777, u'supernatural[n]': 0.6728506684303284, u'natural[n]': 0.6603943109512329, u'thing[v]': 0.6481167078018188, u'encyclopaedia[n]': 0.7208601236343384, u'lubbock[n]': 0.6982893943786621, u'britannica[n]': 0.6582924723625183, u'brehm[n]': 0.655703604221344, u'aboriginal[n]': 0.6583189368247986, u'galton[n]': 0.6470434069633484, u'superstitions[n]': 0.6797428131103516, u'plants[n]': 0.7485312819480896, u'beasts[n]': 0.6604697108268738, u'habits[n]': 0.6509864330291748, u'many[n]': 0.7210800647735596, u'solitary[n]': 0.6628761291503906, u'boas[n]': 0.7080485224723816, u'extinct[n]': 0.6494645476341248, u'birds[n]': 0.7121366858482361, u'unfamiliar[n]': 0.6558777689933777, u'folk-medicine[n]': 0.6483616232872009, u'interesting[n]': 0.6455312967300415, u'characters[n]': 0.6443537473678589, u'modern[n]': 0.6461368203163147, u'domesticated[n]': 0.6881701946258545, u'hints[n]': 0.7300379276275635, u'osteology[n]': 0.6448023319244385, u'insectivorous[n]': 0.7091681361198425, u'useful[n]': 0.6856311559677124}}, 'parent': False, 'label': 'LIVE ANIMALS', 'other': False, 'row': {'End date': '', 'Indent': '', 'Description': 'LIVE ANIMALS', 'Language': 'EN', 'Hier.Pos.': '2', 'Goods code': '0100000000 80', 'Start date': '31/12/1971 '}}
    
    MODEL = None
    def __init__(self, *args, **kwargs):
        super(MatchTest, self).__init__(*args, **kwargs)
        self.MODEL = Model("/Users/ed4565/Development/led-discovery/data/analysis/gutenberg2vec/word2vec.model")
    
    def test_terms(self):
        q =  'Live Animals'
        
        print q
        n1 = self.CEREALS
        n2 = self.ANIMALS
        
        print matchTerms(q, 'Cereals', self.MODEL)
        print matchTerms(q, 'Live Animals', self.MODEL)
        
if __name__ == '__main__':
    unittest.main()